<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>BaseR — Farcaster Bridge</title>

    <!-- OG / Twitter -->
    <meta property="og:title" content="BaseR — Farcaster Bridge" />
    <meta property="og:description" content="BaseR'ı Farcaster Mini App içinde, cüzdan pas-through ile kullan." />
    <meta property="og:image" content="https://baser-qh0.caffeine.xyz/og.png" />
    <meta name="twitter:card" content="summary_large_image" />

    <!-- Farcaster Frame Manifest -->
    <meta
      name="fc:frame"
      content='{
        "version":"1",
        "imageUrl":"https://baser-qh0.caffeine.xyz/og.png",
        "button":{"title":"Open BaseR","action":{"type":"launch_miniapp","url":"https://mrvoodoonft.github.io/BaseRFarcaster/"}},
        "accountAssociation":{
          "header":"eyJmaWQiOjM4MzYxMiwidHlwZSI6ImF1dGgiLCJrZXkiOiIweEY1NWMwOWJiMzc4MzlmOGFiZWIzM0Q1QTI1NmZhNjU0OUM4MjlmQ0IifQ",
          "payload":"eyJkb21haW4iOiJtcnZvb2Rvb25mdC5naXRodWIuaW8ifQ==",
          "signature":"0x7aafc0ef10d6b4ad95a6b82b6c70ec9db31f278c6a1e6b7b1b1f40d9a63d2f9b5a26cbb21f12a3d4dfcc9cecc9ad9a248d820e80f1e8c31a2a04103fb8c3cfe61b"
        }
      }'
    />

    <style>
      :root { -webkit-text-size-adjust: 100%; }
      /* Dış sayfanın scroll’unu kapatma, içeriği min 1 viewport yüksekliğinde tut */
      html, body { min-height: 100vh; margin: 0; }
      body {
        background:#0b0b0b; color:#fff; font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
        display:flex; flex-direction:column; overflow:auto;
      }
      .topbar { padding:10px 14px; font-size:14px; color:#aaa; }
      .loading {
        position: fixed; inset: 0; display:flex; align-items:center; justify-content:center;
        color:#bbb; font-size:14px; pointer-events:none;
      }
      /* İframe’in kendi içinde scroll etmesine izin ver */
      #frame-wrap { flex:1; min-height: 0; }
      iframe {
        border:0; display:block; width:100%;
        height: 100dvh;               /* mobil için güvenli viewport */
        overflow:auto;                 /* iç scroll bar */
        -webkit-overflow-scrolling: touch; /* iOS momentum scroll */
      }
    </style>
  </head>

  <body>
    <div class="topbar">BaseR · Farcaster Bridge</div>
    <div class="loading" id="loading">Farcaster cüzdan başlatılıyor...</div>

    <div id="frame-wrap">
      <iframe
        id="baser-frame"
        src="https://baser-qh0.caffeine.xyz/"
        scrolling="yes"
        allow="clipboard-read; clipboard-write; accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
      ></iframe>
    </div>

    <script type="module">
      import { sdk } from "https://miniapps.farcaster.xyz/sdk.js";

      async function initFarcasterWallet() {
        const loadingEl = document.getElementById("loading");
        try {
          if (!window.ethereum) {
            const provider = await sdk.wallet.getEthereumProvider();
            if (provider) {
              window.ethereum = provider;
              console.log("✅ Farcaster wallet window.ethereum olarak atandı.");
            } else {
              console.warn("⚠️ Farcaster wallet bulunamadı — view-only.");
            }
          }
        } catch (err) {
          console.error("❌ Farcaster wallet init hatası:", err);
        } finally {
          loadingEl.style.display = "none";
        }
      }
      initFarcasterWallet();
    </script>
  </body>
</html>
